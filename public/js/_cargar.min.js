const previewFile=document.getElementById("contenedorImg"),inputElement=document.querySelector("input[type=file]"),pu_descripcion=document.getElementById("pu_descripcion");let numOfFiles=document.getElementById("num-of-files");function limpiarContenedorImg(){inputElement.value="";let e=document.querySelectorAll("figure");e.forEach(e=>{e.parentNode.removeChild(e)})}$(document).ready(function(){$("#upload-form").on("submit",function(e){e.preventDefault();var t=new FormData(this);$("#progress-bar").show(),$("#progress").width("0%");var n=document.getElementById("message-upload");if(""!=inputElement.value)var i=inputElement.files[0].name.split(".").pop();axios.post($(this).attr("action"),t,{headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content"),"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=e.loaded/e.total*100;$("#progress").width(t+"%")}}).then(function(e){pu_descripcion.value="","jpg"==i||"jpeg"==i||"png"==i||"webp"==i?limpiarContenedorImg():"mp4"==i&&limpiarContenedorImg(),n.style.display="block",n.textContent="Se ha publicado con exito",setTimeout(()=>{n.style.display="none",n.textContent=""},4e3),$("#progress-bar").hide()}).catch(function(e){console.error(e),$("#progress-bar").hide(); window.location.href = "/";})})});var options=document.querySelectorAll("input[name=options]"),text_message=document.getElementById("text-message"),text_movie=document.getElementById("message-movie"),files1=document.getElementById("files1");function preview(){let e=0;function t(t){e+=t,numOfFiles.textContent=`${e} Files Selected`,inputElement.disabled=e>=4}for(let n=0;n<inputElement.files.length;n++){let i=new FileReader,l=document.createElement("figure"),o=document.createElement("figcaption"),s=document.createElement("button");l.appendChild(o),s.className="btn btn-danger btn-sm mt-2",s.textContent="Eliminar",s.addEventListener("click",()=>{l.remove(),t(-1)}),l.appendChild(s),i.onload=()=>{let e=inputElement.files[n].name.split(".").pop().toLowerCase();if(["jpg","jpeg","png","webp"].includes(e)){let t=document.createElement("img");t.setAttribute("src",i.result),l.insertBefore(t,o)}else if(["mp4","webm","ogg"].includes(e)){let s=document.createElement("video");s.setAttribute("src",i.result),s.setAttribute("controls",!0),l.insertBefore(s,o),s.play()}},previewFile.style.display="block",previewFile.appendChild(l),i.readAsDataURL(inputElement.files[n]),t(1)}}files1.style.display="none",text_movie.style.display="none",previewFile.style.display="none",text_message.textContent="\xa1Ohh maravilloso!, expresa lo que estas pensando",files1.style.display="none",previewFile.src="",previewFile.style.display="none",text_movie.style.display="none",options.forEach(function(e){e.addEventListener("change",function(){this.checked&&("img"==e.value?(text_message.textContent="Has seleccionado la opci\xf3n de publicaci\xf3n de contenido de solo imagen.",files1.style.display="block",previewFile.style.display="block",text_movie.style.display="block",text_movie.textContent="Formatos permitidos .jpg .jpeg .png .webp"):"text"==e.value?(text_message.textContent="\xa1Ohh maravilloso!, expresa lo que estas pensando",files1.style.display="none",previewFile.src="",previewFile.style.display="none",text_movie.style.display="none"):"movie"==e.value&&(text_message.textContent="Has seleccionado la opci\xf3n de publicaci\xf3n de contenido de solo video.",files1.style.display="block",previewFile.src="",previewFile.style.display="block",text_movie.style.display="block",text_movie.textContent="Formatos permitidos .mp4"))})}),inputElement.addEventListener("change",function(){var e=inputElement.files[0];if(e.size>68157440){alert("El tama\xf1o del video no puede superar los 60 MB."),inputElement.value="";return}var t=document.createElement("video");t.src=URL.createObjectURL(e),t.addEventListener("loadedmetadata",function(){t.duration>260&&(alert("La duraci\xf3n del video no puede superar los 4 minutos."),inputElement.value=""),URL.revokeObjectURL(t.src)})});const count=document.getElementById("count"),maxLength=pu_descripcion.getAttribute("maxlength");pu_descripcion.addEventListener("input",function(){let e=pu_descripcion.value.length;count.textContent=`Caracteres: ${e}/${maxLength}`});